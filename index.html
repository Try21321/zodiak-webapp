<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ì–æ—Ä–æ—Å–∫–æ–ø ‚Äî Telegram WebApp</title>
  <meta name="description" content="–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≥–æ—Ä–æ—Å–∫–æ–ø –≤ Telegram WebApp: –≤—ã–±–µ—Ä–∏ –∑–Ω–∞–∫ –∏ —á–∏—Ç–∞–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è, –∑–∞–≤—Ç—Ä–∞ –∏ –Ω–µ–¥–µ–ª—é." />
  <!-- Telegram WebApp SDK (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å—Ä–µ–¥–µ Telegram; –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è) -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg: #0f1115;
      --card: #161a22;
      --text: #e6e8ee;
      --muted: #a2a8b3;
      --primary: #6aa0ff;
      --accent: #ffc46a;
      --ok: #2ecc71;
      --shadow: 0 10px 24px rgba(0,0,0,.35);
      --radius: 16px;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell,
      Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg); color: var(--text);
      -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    .container { max-width: 980px; margin: 0 auto; padding: 20px; }
    header { display:flex; align-items:center; gap:12px; margin-bottom:16px; }
    .logo { width:40px; height:40px; display:grid; place-items:center; background:var(--card); border-radius:12px; box-shadow: var(--shadow); }
    .title { font-weight: 800; letter-spacing:.2px; }
    .subtitle { color: var(--muted); font-size: 14px; }

    .grid { display:grid; grid-template-columns: repeat(6, 1fr); gap: 10px; }
    @media (max-width: 860px) { .grid { grid-template-columns: repeat(4, 1fr); } }
    @media (max-width: 520px) { .grid { grid-template-columns: repeat(3, 1fr); } }

    .card { background: var(--card); border-radius: var(--radius); padding: 12px; text-align:center; cursor:pointer; transition: transform .08s ease, background .15s ease; box-shadow: var(--shadow); }
    .card:hover { transform: translateY(-2px); }
    .card.active { outline: 2px solid var(--primary); background: #1a2130; }
    .sym { font-size: 24px; line-height:1; }
    .sign { font-size: 12px; color: var(--muted); margin-top: 6px; }

    .panel { margin-top: 16px; background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow); overflow:hidden; }
    .panel-head { display:flex; align-items:center; justify-content:space-between; padding: 14px 16px; border-bottom: 1px solid rgba(255,255,255,.06); }
    .panel-title { font-weight: 700; display:flex; align-items:center; gap:10px; }
    .chip { font-size: 12px; color: var(--muted); background: rgba(255,255,255,.06); padding:4px 8px; border-radius: 999px; }

    .tabs { display:flex; gap: 8px; padding: 12px 12px 0; flex-wrap: wrap; }
    .tab { border: 1px solid rgba(255,255,255,.08); background: transparent; color: var(--text); padding: 8px 12px; border-radius: 10px; cursor:pointer; font-weight:600; }
    .tab.active { background: var(--primary); border-color: var(--primary); color:#0b1220; }

    .content { padding: 12px 16px 16px; }
    .text { color: var(--text); line-height: 1.55; white-space: pre-wrap; }
    .muted { color: var(--muted); }

    .bar { display:flex; align-items:center; gap: 10px; padding: 8px 12px; background: #121620; border-radius: 12px; margin: 12px 16px; }
    .bar input[type="search"] { flex:1; background: transparent; border: 0; color: var(--text); font-size: 14px; outline: none; }

    .footer { text-align:center; color: var(--muted); font-size: 12px; margin: 18px 0 40px; }
    .link { color: var(--primary); text-decoration: none; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">üîÆ</div>
      <div>
        <div class="title">–ì–æ—Ä–æ—Å–∫–æ–ø</div>
        <div class="subtitle">–í—ã–±–µ—Ä–∏—Ç–µ –∑–Ω–∞–∫ –∑–æ–¥–∏–∞–∫–∞ –∏ –¥–µ–Ω—å ‚Äî –≤—Å—ë –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ</div>
      </div>
    </header>

    <div class="bar">
      <span class="muted">üîé</span>
      <input id="search" type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∑–Ω–∞–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: –í–µ—Å—ã, Libra)" />
    </div>

    <section id="signs" class="grid" aria-label="–ó–Ω–∞–∫–∏ –∑–æ–¥–∏–∞–∫–∞"></section>

    <section id="panel" class="panel" hidden>
      <div class="panel-head">
        <div class="panel-title"><span id="panel-emoji" class="sym"></span><span id="panel-name"></span></div>
        <span id="panel-date" class="chip"></span>
      </div>
      <div class="tabs">
        <button class="tab" data-range="today">–°–µ–≥–æ–¥–Ω—è</button>
        <button class="tab" data-range="tomorrow">–ó–∞–≤—Ç—Ä–∞</button>
        <button class="tab" data-range="week">–ù–µ–¥–µ–ª—è</button>
      </div>
      <div class="content">
        <div id="text" class="text"></div>
        <div id="hint" class="muted" style="margin-top:10px"></div>
      </div>
    </section>

    <div class="footer">
      –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–ª–∏ –≤–Ω–µ Telegram: WebApp —Ñ—É–Ω–∫—Ü–∏–∏ (—Ç–µ–º–∞, –∫–Ω–æ–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏) —Å–∫—Ä—ã—Ç—ã. <a class="link" href="#" id="reset">–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</a>
    </div>
  </div>

  <script>
    // ====== –î–ê–ù–ù–´–ï (–∑–∞–ø–æ–ª–Ω—è–π—Ç–µ —Å–≤–æ–∏–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏) ======
    // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç –∏ \n –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–æ–≤. –í—ã –º–æ–∂–µ—Ç–µ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ä–∞–∑ –≤ –º–µ—Å—è—Ü.
    const DATA = {
      aries:     { emoji:"‚ôà", ru:"–û–≤–µ–Ω", en:"Aries",     today:"–≠–Ω–µ—Ä–≥–∏—è –Ω–∞ –ø–∏–∫–µ. –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ —Å–º–µ–ª–æ.", tomorrow:"–§–æ–∫—É—Å –Ω–∞ –¥–µ–Ω—å–≥–∞—Ö ‚Äî –ø–æ–ª–µ–∑–Ω—ã–µ –∏–¥–µ–∏.", week:"–ù–µ–¥–µ–ª—è —è—Å–Ω–æ—Å—Ç–∏: –∑–∞–∫—Ä–æ–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã." },
      taurus:    { emoji:"‚ôâ", ru:"–¢–µ–ª–µ—Ü", en:"Taurus",   today:"–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏.", tomorrow:"–ü–æ–º–æ–≥–∏—Ç–µ –±–ª–∏–∑–∫–æ–º—É ‚Äî —ç—Ç–æ –≤–µ—Ä–Ω—ë—Ç—Å—è.", week:"–ù–µ–¥–µ–ª—è –∑–∞–±–æ—Ç—ã –æ —Å–µ–±–µ –∏ –¥–æ–º–µ." },
      gemini:    { emoji:"‚ôä", ru:"–ë–ª–∏–∑–Ω–µ—Ü—ã", en:"Gemini", today:"–û–±—â–∞–π—Ç–µ—Å—å ‚Äî –∏–∑ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ —Ä–æ–¥–∏—Ç—Å—è —à–∞–Ω—Å.", tomorrow:"–ë–µ—Ä–µ–≥–∏—Ç–µ –≤—Ä–µ–º—è ‚Äî –Ω–µ —Ä–∞—Å–ø—ã–ª—è–π—Ç–µ—Å—å.", week:"–ù–µ–¥–µ–ª—è –∏–¥–µ–π –∏ –ø–æ–ª–µ–∑–Ω—ã—Ö –∑–Ω–∞–∫–æ–º—Å—Ç–≤." },
      cancer:    { emoji:"‚ôã", ru:"–†–∞–∫", en:"Cancer",     today:"–î–æ–º –∏ —É—é—Ç –¥–∞–¥—É—Ç —Å–∏–ª—ã.", tomorrow:"–°–¥–µ–ª–∞–π—Ç–µ –ø–∞—É–∑—É, –Ω–µ —Å–ø–µ—à–∏—Ç–µ.", week:"–ù–µ–¥–µ–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è." },
      leo:       { emoji:"‚ôå", ru:"–õ–µ–≤", en:"Leo",       today:"–í–∞—Å –∑–∞–º–µ—Ç—è—Ç. –ë—É–¥—å—Ç–µ —â–µ–¥—Ä—ã –Ω–∞ –ø–æ—Ö–≤–∞–ª—É.", tomorrow:"–°–º–µ–ª—ã–π —à–∞–≥ –æ–∫—É–ø–∏—Ç—Å—è.", week:"–ù–µ–¥–µ–ª—è –ª–∏–¥–µ—Ä—Å—Ç–≤–∞ –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞." },
      virgo:     { emoji:"‚ôç", ru:"–î–µ–≤–∞", en:"Virgo",     today:"–ü–æ—Ä—è–¥–æ–∫ –≤ –¥–µ–ª–∞—Ö ‚Äî –ø–æ—Ä—è–¥–æ–∫ –≤ –º—ã—Å–ª—è—Ö.", tomorrow:"–ú–µ–Ω—å—à–µ –∫—Ä–∏—Ç–∏–∫–∏ ‚Äî –±–æ–ª—å—à–µ –ø–æ–ª—å–∑—ã.", week:"–ù–µ–¥–µ–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∑–¥–æ—Ä–æ–≤—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫." },
      libra:     { emoji:"‚ôé", ru:"–í–µ—Å—ã", en:"Libra",     today:"–ò—â–∏—Ç–µ –±–∞–ª–∞–Ω—Å ‚Äî –∏ –æ–Ω –Ω–∞–π–¥—ë—Ç—Å—è.", tomorrow:"–°–æ–≥–ª–∞—Å–∏–µ —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥.", week:"–ù–µ–¥–µ–ª—è –ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤ –∏ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π." },
      scorpio:   { emoji:"‚ôè", ru:"–°–∫–æ—Ä–ø–∏–æ–Ω", en:"Scorpio", today:"–ò–Ω—Ç—É–∏—Ü–∏—è –ø–æ–¥—Å–∫–∞–∂–µ—Ç –≤–µ—Ä–Ω–æ.", tomorrow:"–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ª–∏—à–Ω–∏–π –¥—Ä–∞–º–∞—Ç–∏–∑–º.", week:"–ù–µ–¥–µ–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ —Ä–µ—à–µ–Ω–∏–π." },
      sagittarius:{emoji:"‚ôê", ru:"–°—Ç—Ä–µ–ª–µ—Ü", en:"Sagittarius", today:"–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –ø–æ–µ–∑–¥–∫—É –∏–ª–∏ –æ–±—É—á–µ–Ω–∏–µ.", tomorrow:"–ù–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ –∑–≤–æ–Ω–æ–∫.", week:"–ù–µ–¥–µ–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤." },
      capricorn: { emoji:"‚ôë", ru:"–ö–æ–∑–µ—Ä–æ–≥", en:"Capricorn", today:"–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ = —Ä–µ–∑—É–ª—å—Ç–∞—Ç.", tomorrow:"–ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –∫–æ–ª–ª–µ–≥—É ‚Äî —É—Å–∏–ª–∏—Ç–µ —Å–æ—é–∑.", week:"–ù–µ–¥–µ–ª—è –∫–∞—Ä—å–µ—Ä—ã –∏ —Ü–µ–ª–µ–π." },
      aquarius:  { emoji:"‚ôí", ru:"–í–æ–¥–æ–ª–µ–π", en:"Aquarius", today:"–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ = –ø—Ä–æ—Ä—ã–≤.", tomorrow:"–°–º–µ–Ω–∏—Ç–µ –æ–±—Å—Ç–∞–Ω–æ–≤–∫—É ‚Äî –ø–æ—è–≤—è—Ç—Å—è –∏–¥–µ–∏.", week:"–ù–µ–¥–µ–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ —Å–≤–æ–±–æ–¥—ã." },
      pisces:    { emoji:"‚ôì", ru:"–†—ã–±—ã", en:"Pisces",   today:"–ü–æ—Å–ª—É—à–∞–π—Ç–µ –º—É–∑—ã–∫—É ‚Äî —ç—Ç–æ –≤–¥–æ—Ö–Ω–æ–≤–∏—Ç.", tomorrow:"–û–±–µ—Ä–µ–≥–∞–π—Ç–µ –≥—Ä–∞–Ω–∏—Ü—ã.", week:"–ù–µ–¥–µ–ª—è –º—è–≥–∫–æ–π —Å–∏–ª—ã –∏ –∏–Ω—Ç—É–∏—Ü–∏–∏." }
    };

    // ====== –†–ï–ù–î–ï–† –°–ï–¢–ö–ò –ó–ù–ê–ö–û–í ======
    const $signs = document.getElementById('signs');
    const $panel = document.getElementById('panel');
    const $panelEmoji = document.getElementById('panel-emoji');
    const $panelName = document.getElementById('panel-name');
    const $panelDate = document.getElementById('panel-date');
    const $text = document.getElementById('text');
    const $hint = document.getElementById('hint');
    const $search = document.getElementById('search');

    const entries = Object.entries(DATA);

    function renderGrid(filter = '') {
      const q = filter.trim().toLowerCase();
      $signs.innerHTML = '';
      entries.forEach(([key, s]) => {
        const hay = `${s.ru} ${s.en} ${key}`.toLowerCase();
        if (q && !hay.includes(q)) return;
        const card = document.createElement('button');
        card.className = 'card';
        card.dataset.key = key;
        card.innerHTML = `<div class="sym">${s.emoji}</div><div class="sign">${s.ru} / ${s.en}</div>`;
        card.addEventListener('click', () => selectSign(key));
        $signs.appendChild(card);
      });
    }

    $search.addEventListener('input', (e) => renderGrid(e.target.value));

    // ====== –í–´–ë–û–† –ó–ù–ê–ö–ê –ò –¢–ê–ë–û–í ======
    let current = { sign: null, range: 'today' };

    function selectSign(key) {
      current.sign = key;
      localStorage.setItem('zodiac:selected', key);
      updatePanel();
      window.scrollTo({ top: document.querySelector('#panel').offsetTop - 8, behavior: 'smooth' });
    }

    function selectRange(range) {
      current.range = range;
      localStorage.setItem('zodiac:range', range);
      updatePanel();
    }

    function updatePanel() {
      document.querySelectorAll('.card').forEach(c => c.classList.toggle('active', c.dataset.key===current.sign));
      if (!current.sign) { $panel.hidden = true; return; }
      const s = DATA[current.sign];
      $panel.hidden = false;
      $panelEmoji.textContent = s.emoji;
      $panelName.textContent = `${s.ru} / ${s.en}`;
      // –¥–∞—Ç–∞ –¥–ª—è "—Å–µ–≥–æ–¥–Ω—è"/"–∑–∞–≤—Ç—Ä–∞"/–Ω–µ–¥–µ–ª–∏
      const now = new Date();
      const fmt = d => d.toLocaleDateString(undefined, { day:'2-digit', month:'short' });
      let label = '';
      if (current.range === 'today') label = `–°–µ–≥–æ–¥–Ω—è ‚Ä¢ ${fmt(now)}`;
      else if (current.range === 'tomorrow') label = `–ó–∞–≤—Ç—Ä–∞ ‚Ä¢ ${fmt(new Date(now.getTime()+86400000))}`;
      else {
        const end = new Date(now.getTime()+6*86400000);
        label = `–ù–µ–¥–µ–ª—è ‚Ä¢ ${fmt(now)} ‚Äî ${fmt(end)}`;
      }
      $panelDate.textContent = label;

      document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.dataset.range===current.range));
      $text.textContent = s[current.range] || '–¢–µ–∫—Å—Ç –Ω–µ –∑–∞–¥–∞–Ω.';
      $hint.textContent = '–°–æ–≤–µ—Ç: –¥–æ–±–∞–≤—å—Ç–µ –≤ –ò–∑–±—Ä–∞–Ω–Ω–æ–µ –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–∞—Å—Å—ã–ª–∫—É –≤ –±–æ—Ç–µ.';

      // Telegram MainButton –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏
      if (window.Telegram && window.Telegram.WebApp && Telegram.WebApp.initDataUnsafe) {
        const app = Telegram.WebApp;
        app.MainButton.setText(`–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è: ${s.ru} ‚Äî ${label}`);
        app.MainButton.show();
        app.MainButton.onClick(() => {
          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É (–ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø—É—à–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∑–Ω–∞–∫—É/—Ä–µ–∂–∏–º—É)
          app.sendData(JSON.stringify({ action:'subscribe', sign: current.sign, range: current.range }));
          app.HapticFeedback.impactOccurred('medium');
        });
      }
    }

    document.querySelectorAll('.tab').forEach(btn => btn.addEventListener('click', () => selectRange(btn.dataset.range)));

    // ====== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ======
    function init() {
      renderGrid();
      // –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—ã–±–æ—Ä
      const savedSign = localStorage.getItem('zodiac:selected');
      const savedRange = localStorage.getItem('zodiac:range');
      if (savedSign && DATA[savedSign]) current.sign = savedSign;
      if (savedRange) current.range = savedRange;
      updatePanel();

      // Telegram –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
      if (window.Telegram && window.Telegram.WebApp) {
        const app = Telegram.WebApp;
        app.expand();
        // –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ–º—Å—è –ø–æ–¥ —Ç–µ–º—É Telegram
        document.documentElement.style.setProperty('--bg', app.themeParams.bg_color || getComputedStyle(document.documentElement).getPropertyValue('--bg'));
        document.documentElement.style.setProperty('--card', app.themeParams.secondary_bg_color || getComputedStyle(document.documentElement).getPropertyValue('--card'));
        document.documentElement.style.setProperty('--text', app.themeParams.text_color || getComputedStyle(document.documentElement).getPropertyValue('--text'));
        document.documentElement.style.setProperty('--muted', app.themeParams.hint_color || getComputedStyle(document.documentElement).getPropertyValue('--muted'));
        document.documentElement.style.setProperty('--primary', app.themeParams.button_color || getComputedStyle(document.documentElement).getPropertyValue('--primary'));
      }
    }

    init();

    // –°–±—Ä–æ—Å
    document.getElementById('reset').addEventListener('click', (e)=>{
      e.preventDefault();
      localStorage.removeItem('zodiac:selected');
      localStorage.removeItem('zodiac:range');
      current = { sign:null, range:'today' };
      updatePanel();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  </script>
</body>
</html>



